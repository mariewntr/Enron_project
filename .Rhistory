scale_fill_brewer(palette = "Set3")
employeelist_2 %>% select(status) %>% #select the needed variable
group_by(status) %>% count() %>% #count the number of employee per status
ungroup() %>%
mutate(perc = `n`/sum(`n`),
labels = scales::percent(perc)) %>%
#bar chart
ggplot(aes(reorder(status, perc ,sum),perc, fill = status)) +
geom_bar(stat = "identity") +
coord_flip()+
ylab("status")+
theme(plot.title = element_text(hjust = 0.5, size = 18))+
ggtitle("Number of employee per status in Enron company")+
scale_fill_brewer(palette = "Set3")
employeelist_2 %>% select(status) %>% #select the needed variable
group_by(status) %>% count() %>% #count the number of employee per status
ungroup() %>%
mutate(perc = `n`/sum(`n`),
labels = scales::percent(perc)) %>%
#bar chart
ggplot(aes(reorder(status, perc ,sum),perc, fill = status)) +
geom_bar(stat = "identity") +
coord_flip()+
ylab("status")+
theme(plot.title = element_text(hjust = 0.5, size = 18))+
theme_light()+
ggtitle("Number of employee per status in Enron company")+
scale_fill_brewer(palette = "Set3")
employeelist_2 %>% select(status) %>% #select the needed variable
group_by(status) %>% count() %>% #count the number of employee per status
ungroup() %>%
mutate(perc = `n`/sum(`n`),
labels = scales::percent(perc)) %>%
#bar chart
ggplot(aes(reorder(status, perc ,sum),perc, fill = status)) +
geom_bar(stat = "identity") +
coord_flip()+
# ylab("status")+
theme(plot.title = element_text(hjust = 0.5, size = 18),
legend.position = "none")+
theme_light()+
ggtitle("Number of employee per status in Enron company")+
scale_fill_brewer(palette = "Set3")
employeelist_2 %>% select(status) %>% #select the needed variable
group_by(status) %>% count() %>% #count the number of employee per status
ungroup() %>%
mutate(perc = `n`/sum(`n`),
labels = scales::percent(perc)) %>%
#bar chart
ggplot(aes(reorder(status, perc ,sum),perc, fill = status)) +
geom_bar(stat = "identity") +
coord_flip()+
theme(plot.title = element_text(hjust = 0.5, size = 18),
legend.position = "none")+
theme_light()+
ggtitle("Number of employee per status in Enron company")+
scale_fill_brewer(palette = "Set3")
employeelist_2 %>% select(status) %>% #select the needed variable
group_by(status) %>% count() %>% #count the number of employee per status
ungroup() %>%
mutate(perc = `n`/sum(`n`),
labels = scales::percent(perc)) %>%
#bar chart
ggplot(aes(reorder(status, perc ,sum),perc, fill = status)) +
geom_bar(stat = "identity") +
coord_flip()+
theme(plot.title = element_text(hjust = 0.5, size = 18),
)+
theme_light(legend.position = "none")+
ggtitle("Number of employee per status in Enron company")+
scale_fill_brewer(palette = "Set3")
employeelist_2 %>% select(status) %>% #select the needed variable
group_by(status) %>% count() %>% #count the number of employee per status
ungroup() %>%
mutate(perc = `n`/sum(`n`),
labels = scales::percent(perc)) %>%
#bar chart
ggplot(aes(reorder(status, perc ,sum),perc, fill = status)) +
geom_bar(stat = "identity") +
coord_flip()+
theme(plot.title = element_text(hjust = 0.5, size = 18),
legend.position = "none")+
theme_light()+
ggtitle("Number of employee per status in Enron company")+
scale_fill_brewer(palette = "Set3")
employeelist_2 %>% select(status) %>% #select the needed variable
group_by(status) %>% count() %>% #count the number of employee per status
ungroup() %>%
mutate(perc = `n`/sum(`n`),
labels = scales::percent(perc)) %>%
#bar chart
ggplot(aes(reorder(status, perc ,sum),perc, fill = status)) +
geom_bar(stat = "identity") +
coord_flip()+
theme(plot.title = element_text(hjust = 0.5, size = 18),
legend.position = "none",
xlab("Percentage of employee"))+
theme_light()+
ggtitle("Number of employee per status in Enron company")+
scale_fill_brewer(palette = "Set3")
employeelist_2 %>% select(status) %>% #select the needed variable
group_by(status) %>% count() %>% #count the number of employee per status
ungroup() %>%
mutate(perc = `n`/sum(`n`),
labels = scales::percent(perc)) %>%
#bar chart
ggplot(aes(reorder(status, perc ,sum),perc, fill = status)) +
geom_bar(stat = "identity") +
coord_flip()+
theme(plot.title = element_text(hjust = 0.5, size = 18),
legend.position = "none")+
labs(
x = "Percentage (%)",
y = "Employee status"
) +
theme_light()+
ggtitle("Number of employee per status in Enron company")+
scale_fill_brewer(palette = "Set3")
employeelist_2 %>% select(status) %>% #select the needed variable
group_by(status) %>% count() %>% #count the number of employee per status
ungroup() %>%
mutate(perc = `n`/sum(`n`),
labels = scales::percent(perc)) %>%
#bar chart
ggplot(aes(reorder(status, perc ,sum),perc, fill = status)) +
geom_bar(stat = "identity") +
coord_flip()+
theme(plot.title = element_text(hjust = 0.5, size = 18),
legend.position = "none")+
labs(
y = "Percentage (%)",
x = "Employee status"
) +
theme_light()+
ggtitle("Number of employee per status in Enron company")+
scale_fill_brewer(palette = "Set3")
employeelist_2 %>% select(status) %>% #select the needed variable
group_by(status) %>% count() %>% #count the number of employee per status
ungroup() %>%
mutate(perc = `n`/sum(`n`),
labels = scales::percent(perc)) %>%
#bar chart
ggplot(aes(reorder(status, perc ,sum),perc, fill = status)) +
geom_bar(stat = "identity") +
coord_flip()+
theme(plot.title = element_text(hjust = 0.5, size = 18),
legend.position = "none")+
labs(
y = "Percentage (%)",
x = "Employee status"
) +
scale_y_continuous()+
theme_light()+
ggtitle("Number of employee per status in Enron company")+
scale_fill_brewer(palette = "Set3")
employeelist_2 %>% select(status) %>% #select the needed variable
group_by(status) %>% count() %>% #count the number of employee per status
ungroup() %>%
mutate(perc = `n`/sum(`n`),
labels = scales::percent(perc)) %>%
#bar chart
ggplot(aes(reorder(status, perc ,sum),perc, fill = status)) +
geom_bar(stat = "identity") +
coord_flip()+
theme(plot.title = element_text(hjust = 0.5, size = 18),
legend.position = "none")+
labs(
y = "Percentage (%)",
x = "Employee status"
) +
scale_y_continuous(labels = label_percent())+
theme_light()+
ggtitle("Number of employee per status in Enron company")+
scale_fill_brewer(palette = "Set3")
employeelist_2 %>% select(status) %>% #select the needed variable
group_by(status) %>% count() %>% #count the number of employee per status
ungroup() %>%
mutate(perc = `n`/sum(`n`),
labels = scales::percent(perc)) %>%
#bar chart
ggplot(aes(reorder(status, perc ,sum),perc, fill = status)) +
geom_bar(stat = "identity") +
coord_flip()+
theme(plot.title = element_text(hjust = 0.5, size = 18),
legend.position = "none")+
labs(
y = "Percentage (%)",
x = "Employee status"
) +
scale_y_continuous(labels = scales::label_percent())+
theme_light()+
ggtitle("Number of employee per status in Enron company")+
scale_fill_brewer(palette = "Set3")
employeelist_2 %>% select(status) %>% #select the needed variable
group_by(status) %>% count() %>% #count the number of employee per status
ungroup() %>%
mutate(perc = `n`/sum(`n`),
labels = scales::percent(perc)) %>%
#bar chart
ggplot(aes(reorder(status, perc ,sum),perc, fill = status)) +
geom_bar(stat = "identity") +
coord_flip()+
theme(plot.title = element_text(hjust = 0.5, size = 18),
legend.position = "none")+
labs(
y = "Percentage (%)",
x = "Employee status"
) +
scale_y_continuous(labels = scales::label_percent())+
theme_light()+
ggtitle("Number of employee per status in Enron company")+
scale_fill_brewer(palette = "Set1")
employeelist_2 %>% select(status) %>% #select the needed variable
group_by(status) %>% count() %>% #count the number of employee per status
ungroup() %>%
mutate(perc = `n`/sum(`n`),
labels = scales::percent(perc)) %>%
#bar chart
ggplot(aes(reorder(status, perc ,sum),perc, fill = status)) +
geom_bar(stat = "identity") +
coord_flip()+
theme(plot.title = element_text(hjust = 0.5, size = 18),
legend.position = "none")+
labs(
y = "Percentage (%)",
x = "Employee status"
) +
scale_y_continuous(labels = scales::label_percent())+
theme_light()+
ggtitle("Number of employee per status in Enron company")+
scale_fill_brewer(palette = "Set4")
employeelist_2 %>% select(status) %>% #select the needed variable
group_by(status) %>% count() %>% #count the number of employee per status
ungroup() %>%
mutate(perc = `n`/sum(`n`),
labels = scales::percent(perc),
status = replace_na(status, "Missing"))
employeelist_2 %>% select(status) %>% #select the needed variable
group_by(status) %>% count() %>% #count the number of employee per status
ungroup() %>%
mutate(perc = `n`/sum(`n`),
labels = scales::percent(perc)) %>%
#bar chart
ggplot(aes(reorder(status, perc ,sum),perc, fill = status)) +
geom_bar(stat = "identity") +
coord_flip()+
theme(plot.title = element_text(hjust = 0.5, size = 18),
legend.position = "none")+
labs(
y = "Percentage (%)",
x = "Employee status"
) +
scale_y_continuous(labels = scales::label_percent())+
theme_light()+
ggtitle("Number of employee per status in Enron company")+
scale_fill_brewer(palette = "Set4", na.value = "grey50")
employeelist_2 %>% select(status) %>% #select the needed variable
group_by(status) %>% count() %>% #count the number of employee per status
ungroup() %>%
mutate(perc = `n`/sum(`n`),
labels = scales::percent(perc)) %>%
#bar chart
ggplot(aes(reorder(status, perc ,sum),perc, fill = status)) +
geom_bar(stat = "identity") +
coord_flip()+
geom_text(aes(label = labels), vjust = -0.5, size = 4) +
scale_y_continuous(labels = scales::percent_format(), limits=c(0,max(employeelist_2$perc)+0.01))+
theme(plot.title = element_text(hjust = 0.5, size = 18),
legend.position = "none")+
labs(y = "Percentage (%)",x = "Employee status") +
theme_minimal()+
ggtitle("Number of employee per status in Enron company")+
scale_fill_brewer(palette = "Set4", na.value = "grey50")
employeelist_2 %>% select(status) %>% #select the needed variable
group_by(status) %>% count() %>% #count the number of employee per status
ungroup() %>%
mutate(perc = `n`/sum(`n`),
labels = scales::percent(perc)) %>%
#bar chart
ggplot(aes(reorder(status, perc ,sum),perc, fill = status)) +
geom_bar(stat = "identity") +
coord_flip()+
geom_text(aes(label = labels), vjust = -0.5, size = 4) +
scale_y_continuous(labels = scales::percent_format(), limits=c(0,max(employeelist_2$perc)+0.01))+
theme(plot.title = element_text(hjust = 0.5, size = 18),
legend.position = "none")+
labs(y = "Percentage (%)",x = "Employee status") +
theme_light()+
ggtitle("Number of employee per status in Enron company")+
scale_fill_brewer(palette = "Set4", na.value = "grey50")
employeelist_2 %>% select(status) %>% #select the needed variable
group_by(status) %>% count() %>% #count the number of employee per status
ungroup() %>%
mutate(perc = `n`/sum(`n`),
labels = scales::percent(perc)) %>%
#bar chart
ggplot(aes(reorder(status, perc ,sum),perc, fill = status)) +
geom_bar(stat = "identity") +
coord_flip()+
#geom_text(aes(label = labels), vjust = -0.5, size = 4) +
scale_y_continuous(labels = scales::percent_format(), limits=c(0,max(employeelist_2$perc)+0.01))+
theme(plot.title = element_text(hjust = 0.5, size = 18),
legend.position = "none")+
labs(y = "Percentage (%)",x = "Employee status") +
theme_light()+
ggtitle("Number of employee per status in Enron company")+
scale_fill_brewer(palette = "Set4", na.value = "grey50")
employeelist_2 %>% select(status) %>% #select the needed variable
group_by(status) %>% count() %>% #count the number of employee per status
ungroup() %>%
mutate(perc = `n`/sum(`n`),
labels = scales::percent(perc)) %>%
#bar chart
ggplot(aes(reorder(status, perc ,sum),perc, fill = status)) +
geom_bar(stat = "identity") +
coord_flip()+
#geom_text(aes(label = labels), vjust = -0.5, size = 4) +
scale_y_continuous(labels = scales::percent_format())+
theme(plot.title = element_text(hjust = 0.5, size = 18),
legend.position = "none")+
labs(y = "Percentage (%)",x = "Employee status") +
theme_light()+
ggtitle("Number of employee per status in Enron company")+
scale_fill_brewer(palette = "Set4", na.value = "grey50")
employeelist_2 %>% select(status) %>% #select the needed variable
group_by(status) %>% count() %>% #count the number of employee per status
ungroup() %>%
mutate(perc = `n`/sum(`n`),
labels = scales::percent(perc)) %>%
#bar chart
ggplot(aes(reorder(status, perc ,sum),perc, fill = status)) +
geom_bar(stat = "identity") +
coord_flip()+
geom_text(aes(label = labels), vjust = -0.5, size = 4) +
scale_y_continuous(labels = scales::percent_format())+
theme(plot.title = element_text(hjust = 0.5, size = 18),
legend.position = "none")+
labs(y = "Percentage (%)",x = "Employee status") +
theme_light()+
ggtitle("Number of employee per status in Enron company")+
scale_fill_brewer(palette = "Set4", na.value = "grey50")
employeelist_2 %>% select(status) %>% #select the needed variable
group_by(status) %>% count() %>% #count the number of employee per status
ungroup() %>%
mutate(perc = `n`/sum(`n`),
labels = scales::percent(perc)) %>%
#bar chart
ggplot(aes(reorder(status, perc ,sum),perc, fill = status)) +
geom_bar(stat = "identity") +
coord_flip()+
geom_text(aes(label = labels), vjust = -0.7, size = 4) +
scale_y_continuous(labels = scales::percent_format())+
theme(plot.title = element_text(hjust = 0.5, size = 18),
legend.position = "none")+
labs(y = "Percentage (%)",x = "Employee status") +
theme_light()+
ggtitle("Number of employee per status in Enron company")+
scale_fill_brewer(palette = "Set4", na.value = "grey50")
employeelist_2 %>% select(status) %>% #select the needed variable
group_by(status) %>% count() %>% #count the number of employee per status
ungroup() %>%
mutate(perc = `n`/sum(`n`),
labels = scales::percent(perc)) %>%
#bar chart
ggplot(aes(reorder(status, perc ,sum),perc, fill = status)) +
geom_bar(stat = "identity") +
coord_flip()+
geom_text(aes(label = labels), vjust = -0.5, size = 4) +
scale_y_continuous(labels = scales::percent_format())+
theme(plot.title = element_text(hjust = 0.5, size = 18),
legend.position = "none")+
labs(y = "Percentage (%)",x = "Employee status") +
theme_light()+
ggtitle("Number of employee per status in Enron company")+
scale_fill_brewer(palette = "Set4", na.value = "grey50")
employeelist_2 %>% select(status) %>% #select the needed variable
group_by(status) %>% count() %>% #count the number of employee per status
ungroup() %>%
mutate(perc = `n`/sum(`n`),
labels = scales::percent(perc)) %>%
#bar chart
ggplot(aes(reorder(status, perc ,sum),perc, fill = status)) +
geom_bar(stat = "identity") +
coord_flip()+
geom_text(aes(label = labels), vjust = 0.5, size = 4) +
scale_y_continuous(labels = scales::percent_format())+
theme(plot.title = element_text(hjust = 0.5, size = 18),
legend.position = "none")+
labs(y = "Percentage (%)",x = "Employee status") +
theme_light()+
ggtitle("Number of employee per status in Enron company")+
scale_fill_brewer(palette = "Set4", na.value = "grey50")
employeelist_2 %>% select(status) %>% #select the needed variable
group_by(status) %>% count() %>% #count the number of employee per status
ungroup() %>%
mutate(perc = `n`/sum(`n`),
labels = scales::percent(perc)) %>%
#bar chart
ggplot(aes(reorder(status, perc ,sum),perc, fill = status)) +
geom_bar(stat = "identity") +
coord_flip()+
geom_text(aes(label = labels), hjust=0.5, vjust = 0.5, size = 4) +
scale_y_continuous(labels = scales::percent_format())+
theme(plot.title = element_text(hjust = 0.5, size = 18),
legend.position = "none")+
labs(y = "Percentage (%)",x = "Employee status") +
theme_light()+
ggtitle("Number of employee per status in Enron company")+
scale_fill_brewer(palette = "Set4", na.value = "grey50")
employeelist_2 %>% select(status) %>% #select the needed variable
group_by(status) %>% count() %>% #count the number of employee per status
ungroup() %>%
mutate(perc = `n`/sum(`n`),
labels = scales::percent(perc)) %>%
#bar chart
ggplot(aes(reorder(status, perc ,sum),perc, fill = status)) +
geom_bar(stat = "identity") +
coord_flip()+
geom_text(aes(label = labels), vjust = 0.5, size = 4) +
scale_y_continuous(labels = scales::percent_format())+
theme(plot.title = element_text(hjust = 0.5, size = 18),
legend.position = "none")+
labs(y = "Percentage (%)",x = "Employee status") +
theme_light()+
ggtitle("Number of employee per status in Enron company")+
scale_fill_brewer(palette = "Set4", na.value = "grey50")
employeelist_2 %>% select(status) %>% #select the needed variable
group_by(status) %>% count() %>% #count the number of employee per status
ungroup() %>%
mutate(perc = `n`/sum(`n`),
labels = scales::percent(perc)) %>%
#bar chart
ggplot(aes(reorder(status, perc ,sum),perc, fill = status)) +
geom_bar(stat = "identity") +
coord_flip()+
geom_text(aes(label = labels), vjust = 0.5, size = 4) +
scale_y_continuous(labels = scales::percent_format())+
theme(plot.title = element_text(hjust = 0.5, size = 18),
legend.position = "none")+
labs(y = "Percentage (%)",x = "Employee status") +
theme_light()+
ggtitle("Number of employee per status in Enron company")+
scale_fill_brewer(palette = "Set3", na.value = "grey50")
employeelist_2 %>% select(status) %>% #select the needed variable
group_by(status) %>% count() %>% #count the number of employee per status
ungroup() %>%
mutate(perc = `n`/sum(`n`),
labels = scales::percent(perc)) %>%
#bar chart
ggplot(aes(reorder(status, perc ,sum),perc, fill = status)) +
geom_bar(stat = "identity") +
coord_flip()+
geom_text(aes(label = labels), vjust = 0.5, size = 4) +
scale_y_continuous(labels = scales::percent_format())+
theme(#plot.title = element_text(hjust = 0.5, size = 18),
legend.position = "none")+
labs(y = "Percentage (%)",x = "Employee status") +
theme_light()+
ggtitle("Number of employee per status in Enron company")+
scale_fill_brewer(palette = "Set3", na.value = "grey50")
employeelist_2 %>% select(status) %>% #select the needed variable
group_by(status) %>% count() %>% #count the number of employee per status
ungroup() %>%
mutate(perc = `n`/sum(`n`),
labels = scales::percent(perc)) %>%
#bar chart
ggplot(aes(reorder(status, perc ,sum),perc, fill = status)) +
geom_bar(stat = "identity") +
coord_flip()+
geom_text(aes(label = labels), vjust = 0.5, size = 4) +
scale_y_continuous(labels = scales::percent_format())+
labs(y = "Percentage (%)",x = "Employee status") +
theme_light()+
ggtitle("Number of employee per status in Enron company")+
scale_fill_brewer(palette = "Set3", na.value = "grey50")
employeelist_2 %>% select(status) %>% #select the needed variable
group_by(status) %>% count() %>% #count the number of employee per status
ungroup() %>%
mutate(perc = `n`/sum(`n`),
labels = scales::percent(perc)) %>%
#bar chart
ggplot(aes(reorder(status, perc ,sum),perc, fill = status)) +
geom_bar(stat = "identity") +
coord_flip()+
geom_text(aes(label = labels), vjust = 0.5, size = 4) +
scale_y_continuous(labels = scales::percent_format())+
labs(y = "Percentage (%)",x = "Employee status") +
theme_light()+
ggtitle("Number of employee per status in Enron company")+
scale_fill_brewer(palette = "Set3", na.value = "grey50")+
theme(legend.position = "none")
employeelist_2 %>% select(status) %>% #select the needed variable
group_by(status) %>% count() %>% #count the number of employee per status
ungroup() %>%
#calculate the percentage for each status
mutate(perc = `n`/sum(`n`),
labels = scales::percent(perc)) %>%
#bar chart
ggplot(aes(reorder(status, perc ,sum),perc, fill = status)) +
geom_bar(stat = "identity") +
#to invert the axis's position
coord_flip()+
#customize the theme, title and axis labels
geom_text(aes(label = labels), vjust = 0.5, size = 4) +
scale_y_continuous(labels = scales::percent_format())+
ggtitle("Number of employee per status in Enron company")+
labs(y = "Percentage (%)",x = "Employee status") +
theme_light()+
scale_fill_brewer(palette = "Set3", na.value = "grey50")+
theme(legend.position = "none")
View(employeelist_2)
View(df_message)
